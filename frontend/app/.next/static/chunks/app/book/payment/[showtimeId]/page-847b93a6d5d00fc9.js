(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4547],{9310:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}},10644:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_3f8a51"}},19915:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_3f8a51"}},25512:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}},25919:(e,a,t)=>{"use strict";t.d(a,{R2:()=>c,DB:()=>r,x8:()=>n});let s={GET_BY_THEATER:"/users/coupon",GET_ALL:"/users/coupon",CHECK:"/users/coupon/check"};var l=t(77567);let n=async e=>(await l.A.get("".concat(s.GET_BY_THEATER,"/").concat(e))).data,c=async(e,a)=>(await l.A.post("".concat(s.CHECK),{couponCode:a,theaterId:e})).data,r=async e=>{let a=new URLSearchParams;(null==e?void 0:e.page)&&a.append("page",e.page.toString()),(null==e?void 0:e.limit)&&a.append("limit",e.limit.toString());let t=a.toString(),n=t?"".concat(s.GET_ALL,"?").concat(t):s.GET_ALL;return(await l.A.get(n)).data}},26540:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:700,fontStyle:"normal"},className:"__className_81d908"}},30710:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>eN});var s=t(95155),l=t(12115),n=t(35695),c=t(25512),r=t.n(c),o=t(35169),i=t(63081),d=t(44326),m=t(54409),x=t(34540),f=t(90688),u=t(84061),h=t.n(u);let p=e=>{let{totalAmount:a,selectedMethod:t,walletBalance:l,isProcessing:n,onPayment:c,isRazorpayLoaded:r=!0}=e,o=!t||"upi"==t||null!==l&&"wallet"==t&&Number(a)>l||n||"razorpay"===t&&!r;return(0,s.jsx)("button",{onClick:c,disabled:o,className:"".concat(h().className," w-full py-4 rounded-xl text-lg transition-all duration-300 ").concat(o?"bg-gray-600 text-gray-400 cursor-not-allowed border border-gray-600/30":"bg-white text-black hover:bg-gradient-to-tr hover:from-violet-300 border hover:to-yellow-100 font-medium py-4 rounded-xl transition-all duration-200 transform hover:scale-[1.02]"),children:n?(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Processing Payment..."]}):"razorpay"!==t||r?"Pay ₹".concat(a):(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-gray-400/30 border-t-gray-400 rounded-full animate-spin"}),"Loading Razorpay..."]})})};var y=t(59556),g=t(7170),b=t.n(g),N=t(10052),j=t.n(N),v=t(54416);let w=e=>{let{selectedPaymentMethod:a,onSelectPaymentMethod:t,isProcessing:l,walletBalance:n,setIsProcessing:c,handlePayment:r,onClose:o,totalAmount:i,isRazorpayLoaded:d=!0}=e;return(0,s.jsx)("div",{className:"w-full max-w-lg bg-black/90 rounded-2xl border border-gray-500/30 shadow-2xl",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"".concat(b().className," text-white text-xl mb-1"),children:"Choose Payment Method"}),(0,s.jsx)("p",{className:"".concat(j().className," text-gray-400 text-sm"),children:"Select your preferred payment option"})]}),(0,s.jsx)("button",{onClick:o,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(v.A,{className:"w-5 h-5 text-gray-400"})})]}),!d&&(0,s.jsx)("div",{className:"".concat(j().className," text-center text-gray-400 mb-4 p-3 bg-white/5 rounded-lg border border-gray-600/30"),children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-gray-400/30 border-t-gray-400 rounded-full animate-spin"}),"Loading payment options..."]})}),(0,s.jsx)(y.C,{totalAmount:i,walletBalance:n,selectedMethod:a,onMethodSelect:t}),(0,s.jsx)("div",{className:"pt-6 border-t border-gray-600/30",children:(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white/5 rounded-xl border border-gray-500/20 mb-6",children:[(0,s.jsx)("span",{className:"".concat(b().className," text-white text-xl"),children:"TOTAL AMOUNT"}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("span",{className:"".concat(b().className," text-white text-2xl"),children:["₹",i]})})]})}),(0,s.jsx)(p,{totalAmount:i,walletBalance:n,selectedMethod:a,isProcessing:l,onPayment:r,isRazorpayLoaded:d}),(0,s.jsx)("p",{className:"".concat(j().className," text-gray-500 text-xs text-center mt-4"),children:"Your payment is secured with 256-bit SSL encryption"})]})})};var k=t(94622),_=t(13568),S=t(6743),A=t(7430);let C=e=>{let{totalAmount:a,onClose:t}=e,c=(0,n.useRouter)(),[r,o]=(0,l.useState)(""),[i,d]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(null),y=(0,x.d4)(e=>e.booking.bookingData),g=(0,x.wA)();async function b(){try{let e=await (0,A.QI)();p(e.data.balance)}catch(e){console.log(e)}}(0,l.useEffect)(()=>{window.Razorpay?u(!0):new Promise(e=>{let a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.onload=()=>{u(!0),e(!0)},a.onerror=()=>e(!1),document.body.appendChild(a)})},[]),(0,l.useEffect)(()=>{b()},[]);let N=async()=>{if(!window.Razorpay||!m)return void alert("Razorpay SDK failed to load. Please try again.");d(!0);let e=!1;try{var a,t,s;let l=(await (0,k.$)({amount:100*y.totalAmount,currency:"INR"})).data.id;if(!l)throw Error("Invalid order response - missing order ID");let n={key:"rzp_test_UfKgHw2DzvZjyn",amount:100*y.totalAmount,currency:"INR",name:"Movie Tickets",description:"Movie Ticket Booking",order_id:l,handler:async a=>{try{if(e=!0,console.log("Payment successful:",a),(await (0,k.G)({razorpay_payment_id:a.razorpay_payment_id,razorpay_order_id:a.razorpay_order_id,razorpay_signature:a.razorpay_signature,bookingData:y})).success){let e=await (0,f.E)(y);console.log("Booking successful:",e.data),c.push("/booking/success")}else throw Error("Payment verification failed")}catch(e){console.error("Payment verification failed:",e),c.push("/booking/failed"),d(!1)}},prefill:{name:(null==(a=y.userDetails)?void 0:a.name)||"Customer",email:(null==(t=y.userDetails)?void 0:t.email)||"",contact:(null==(s=y.userDetails)?void 0:s.phone)||""},theme:{color:"#ffffff"},modal:{ondismiss:()=>{c.push("/booking/failed"),e||(console.log("Payment cancelled by user"),d(!1))}}},r=new window.Razorpay(n);r.on("payment.failed",function(a){e=!0,console.error("Payment failed:",a.error),r.close(),a.error.description,a.error.code,c.push("/booking/failed"),d(!1)}),r.open()}catch(e){_.Ay.error("Payment Failed"),console.error("Payment initiation failed:",e),c.push("/booking/failed"),d(!1)}};async function j(){try{console.log("booking data as redux",y),console.log(y),d(!0),console.log("ronaldos wallet",y.totalAmount);let e=await (0,f.n)(y.totalAmount,"User");console.log(e.data);let a=await (0,f.E)(y);console.log(a.data),c.push("/booking/success")}catch(e){console.log(e),"Insufficient balance"==e.response.data.message?_.Ay.error(" Insufficient balance \uD83D\uDE35‍\uD83D\uDCAB"):c.push("/booking/failed")}finally{d(!1)}}let v=async()=>{"razorpay"===r?await N():"wallet"==r&&j()};return(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:(0,s.jsx)(w,{walletBalance:h,selectedPaymentMethod:r,onSelectPaymentMethod:e=>{o(e),g((0,S._Z)({paymentMethod:e}))},isProcessing:i,setIsProcessing:d,handlePayment:v,totalAmount:a,onClose:t,isRazorpayLoaded:m})})};var F=t(45289),L=t.n(F),I=t(9310),P=t.n(I),T=t(59002),D=t.n(T),E=t(70690),z=t.n(E),R=t(17580);let M=e=>{let{selectedSeats:a,seatBreakdown:t}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(R.A,{className:"w-5 h-5 text-white"}),(0,s.jsxs)("h3",{className:"".concat(z().className," text-white text-lg"),children:["Selected Seats (",(null==a?void 0:a.length)||0,")"]})]})}),a&&a.length>0?(0,s.jsx)("div",{className:"flex flex-wrap gap-2.5 mb-4",children:a.map((e,a)=>(0,s.jsx)("div",{className:"".concat(D().className," px-3 py-2 bg-white/15 border border-gray-500/40 rounded-md text-white text-[12px] font-medium"),children:e},"".concat(e,"-").concat(a)))}):(0,s.jsx)("div",{className:"text-gray-400 text-[12px] mb-4",children:"No seats selected"}),(0,s.jsx)("div",{className:"space-y-3",children:t&&t.length>0?t.map((e,a)=>{let t=(e=>{let a=e.toLowerCase();return a.includes("vip")?{backgroundColor:"#EAB308",borderColor:"#CA8A04"}:a.includes("premium")?{backgroundColor:"#9333EA",borderColor:"#7C3AED"}:a.includes("normal")||a.includes("regular")||a.includes("standard")?{backgroundColor:"#06B6D4",borderColor:"#0891B2"}:{backgroundColor:"#6B7280",borderColor:"#4B5563"}})(e.type);return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 border border-gray-600/20",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-3.5 h-3.5 rounded-full border",style:{backgroundColor:t.backgroundColor,borderColor:t.borderColor}}),(0,s.jsx)("span",{className:"".concat(D().className," text-white text-[12px]"),children:e.displayType||"".concat(e.type," - ").concat(e.seats[0])})]}),(0,s.jsxs)("span",{className:"".concat(z().className," text-white text-[13px]"),children:["₹",e.total]})]},"".concat(e.seats[0],"-").concat(a))}):(0,s.jsx)("div",{className:"text-gray-400 text-[12px]",children:"No seat breakdown available"})})]})};var B=t(95247),W=t.n(B),O=t(52006),U=t.n(O),Y=t(38564),G=t(4516),H=t(69074),q=t(14186);let K=e=>{let{data:a}=e;return(0,s.jsxs)("div",{className:"flex items-start gap-6 pb-6 border-b border-gray-600/30",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-20 h-28 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-xl shadow-lg flex items-center justify-center",children:(0,s.jsx)("img",{src:a.moviePoster,className:"w-full rounded-xl h-full",alt:""})}),(0,s.jsx)("div",{className:"absolute -top-1 -right-1 bg-yellow-400 rounded-full p-1",children:(0,s.jsx)(Y.A,{className:"w-3 h-3 text-black"})})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"".concat(U().className," text-white text-2xl mb-3"),children:a.movieTitle}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-300",children:[(0,s.jsx)(G.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{className:"".concat(W().className," text-sm"),children:[a.theaterName," • ",a.screenName]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-6 text-gray-300",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(H.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"".concat(W().className," text-sm"),children:a.showDate})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(q.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"".concat(W().className," text-sm"),children:a.showTime})]})]}),(a.format||a.language)&&(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-3",children:[a.format&&(0,s.jsx)("span",{className:"".concat(W().className," px-2 py-1 bg-transparent text-white text-xs rounded-full"),children:a.format}),a.language&&(0,s.jsx)("span",{className:"".concat(W().className," px-2 py-1 bg-transparent text-white text-xs rounded-full"),children:a.language})]})]})]})]})};var Z=t(36632),V=t.n(Z),Q=t(10644),$=t.n(Q),J=t(93335),X=t.n(J),ee=t(81284);let ea=e=>{let{data:a}=e;return(0,s.jsxs)("div",{className:"pt-6 border-t border-gray-600/30",children:[(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"".concat(V().className," text-gray-400"),children:"Subtotal"}),(0,s.jsxs)("span",{className:"".concat($().className," text-white"),children:["₹",a.subtotal]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"".concat(V().className," text-gray-400"),children:"Convenience Fee (5%)"}),(0,s.jsx)(ee.A,{className:"w-3 h-3 text-gray-500"})]}),(0,s.jsxs)("span",{className:"".concat($().className," text-white"),children:["₹",a.convenienceFee]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"".concat(V().className," text-gray-400"),children:"Taxes & GST (18%)"}),(0,s.jsxs)("span",{className:"".concat($().className," text-white"),children:["₹",a.taxes]})]}),a.discount&&a.discount>0&&(0,s.jsxs)("div",{className:"flex justify-between items-center rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"".concat(V().className," text-green-400"),children:"Coupon Discount"})})}),(0,s.jsxs)("span",{className:"".concat($().className," text-green-400 font-bold"),children:["-₹",a.discount]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white/5 rounded-xl border border-gray-500/20 mb-6",children:[(0,s.jsx)("span",{className:"".concat(X().className," text-white text-xl"),children:"TOTAL AMOUNT"}),(0,s.jsxs)("div",{className:"text-right",children:[a.discount&&a.discount>0&&(0,s.jsxs)("div",{className:"".concat(V().className," text-gray-400 line-through text-sm"),children:["₹",a.subtotal+a.convenienceFee+a.taxes]}),(0,s.jsxs)("span",{className:"".concat(X().className," text-white text-2xl"),children:["₹",a.total]})]})]})]})};var et=t(11518),es=t.n(et),el=t(90933),en=t.n(el),ec=t(19915),er=t.n(ec),eo=t(26540),ei=t.n(eo),ed=t(43332),em=t(47863),ex=t(66474),ef=t(61432),eu=t(25919),eh=t(59362);let ep=e=>{let{selectedCoupon:a,availableCoupons:t,onSelectCoupon:n,onRemoveCoupon:c,onShowCouponsModal:r,discount:o=0}=e,[i,d]=(0,l.useState)(!1),[m,f]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[p,y]=(0,l.useState)(""),[g,b]=(0,l.useState)(""),N=(0,x.d4)(e=>e.booking.bookingData),j=async e=>{let a=_.Ay.loading("Validating coupon...");try{let t=await (0,eu.R2)(N.theaterId,e);if(console.log(t),t&&t.data)return w(t.data),_.Ay.success("Coupon applied successfully!",{id:a}),{success:!0,data:t.data};return _.Ay.error("Coupon doesn't exist or expired",{id:a}),{success:!1,message:"Coupon doesn't exist or expired"}}catch(e){if(e instanceof eh.pe){var t,s;let l=(null==e||null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Coupon doesn't exist or expired";return _.Ay.error(l,{id:a}),{success:!1,message:l}}}},w=e=>{null==n||n(e),d(!1),y(""),b("")},k=async()=>{if(!m.trim())return void y("Please enter a coupon code");h(!0),y(""),b("");try{let e=await j(m.trim());e&&e.success?(b("Coupon applied successfully!"),f(""),setTimeout(()=>b(""),3e3)):y((null==e?void 0:e.message)||"Coupon doesn't exist or expired")}catch(e){console.error("Unexpected error:",e),y("Failed to apply coupon. Please try again.")}finally{h(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 pt-6 border-t border-gray-600/30",children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center gap-2",children:[(0,s.jsx)(ed.A,{className:"w-5 h-5 text-white"}),(0,s.jsx)("h3",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(er().className," text-white text-lg"),children:"Apply Coupons"})]}),(0,s.jsxs)("button",{onClick:()=>{d(!i),null==r||r()},className:"jsx-3f2fe9c78813ffc5 "+"".concat(en().className," flex items-center gap-2 text-gray-400 hover:text-white transition-all duration-200 text-sm"),children:["View Coupons",i?(0,s.jsx)(em.A,{className:"w-4 h-4 transition-transform duration-200"}):(0,s.jsx)(ex.A,{className:"w-4 h-4 transition-transform duration-200"})]})]}),!a&&(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 mb-4",children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex gap-2",children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex-1 relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Enter coupon code",value:m,onChange:e=>{f(e.target.value.toUpperCase()),y(""),b("")},onKeyPress:e=>{"Enter"===e.key&&k()},disabled:u,className:"jsx-3f2fe9c78813ffc5 "+"w-full px-4 py-3 bg-white/5 border ".concat(p?"border-red-500/50":"border-gray-600/30"," rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500/50 focus:border-orange-500/50 transition-all")}),(0,s.jsx)(ef.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]}),(0,s.jsx)("button",{onClick:k,disabled:u||!m.trim(),className:"jsx-3f2fe9c78813ffc5 "+"px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition-all duration-200 min-w-[100px] disabled:opacity-50 disabled:cursor-not-allowed ".concat(u?"cursor-wait":""),children:u?(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center justify-center",children:(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})}):"Apply"})]}),p&&(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 mt-2 text-red-400 text-sm flex items-center gap-2",children:[(0,s.jsx)(v.A,{className:"w-4 h-4"}),p]}),g&&(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 mt-2 text-green-400 text-sm flex items-center gap-2",children:[(0,s.jsx)(ed.A,{className:"w-4 h-4"}),g]})]}),a&&(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 mb-4",children:(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex justify-between items-center p-3 bg-white/5 border border-green-500/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center gap-2",children:[(0,s.jsx)("div",{style:{backgroundColor:"green",borderColor:"green"},className:"jsx-3f2fe9c78813ffc5 w-3.5 h-3.5 rounded-full border"}),(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center gap-2 justify-center",children:[(0,s.jsx)("span",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(en().className," text-green-400 block"),children:a.name}),(0,s.jsxs)("span",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(en().className," text-green-300 text-xs"),children:[a.discountPercentage,"% OFF"]})]})]}),(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center gap-2",children:(0,s.jsx)("button",{onClick:c,className:"jsx-3f2fe9c78813ffc5 text-white hover:text-red-300 transition-colors",children:"Remove"})})]})})]}),(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 "+"overflow-hidden transition-all duration-300 ease-in-out ".concat(i?"max-h-96 opacity-100 mb-6":"max-h-0 opacity-0"),children:(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 bg-black/10 border border-gray-600/20 rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 p-4 border-b border-gray-600/20",children:(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(ei().className," text-lg text-white"),children:"Available Coupons"}),(0,s.jsxs)("span",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(en().className," text-gray-400"),children:[(null==t?void 0:t.length)||0," available"]})]})}),(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 p-4 overflow-y-auto max-h-80",children:t&&t.length>0?(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 space-y-4",children:t.map((e,t)=>(0,s.jsx)("div",{onClick:()=>w(e),style:{animationDelay:"".concat(50*t,"ms"),animation:i?"slideInFromTop 0.3s ease-out forwards":"none"},className:"jsx-3f2fe9c78813ffc5 p-4 bg-white/5 border border-gray-500/20 rounded-lg cursor-pointer hover:bg-white/10 transition-all duration-200",children:(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5",children:[(0,s.jsx)("h3",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(en().className," text-white text-lg"),children:e.name}),(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 flex items-center gap-2 mt-2",children:[(0,s.jsxs)("span",{className:"jsx-3f2fe9c78813ffc5 border border-orange-300 text-white px-2 py-1 rounded text-xs font-bold",children:[e.discountPercentage,"% OFF"]}),(0,s.jsxs)("span",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(en().className," text-gray-400"),children:["Code: ",e.uniqueId]})]})]}),(null==a?void 0:a._id)===e._id&&(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 text-green-400",children:(0,s.jsx)(ed.A,{className:"w-4 h-4"})})]})},e._id))}):(0,s.jsxs)("div",{className:"jsx-3f2fe9c78813ffc5 text-center py-8",children:[(0,s.jsx)("div",{className:"jsx-3f2fe9c78813ffc5 text-4xl mb-3",children:"\uD83C\uDFAB"}),(0,s.jsx)("p",{className:"jsx-3f2fe9c78813ffc5 "+"".concat(er().className," text-gray-400"),children:"No coupons available for this theater"})]})})]})}),(0,s.jsx)(es(),{id:"3f2fe9c78813ffc5",children:"@keyframes slideInFromTop{from{opacity:0;transform:translatey(-10px)}to{opacity:1;transform:translatey(0)}}"})]})},ey=e=>{let{data:a,onPayment:t,selectedCoupon:l,availableCoupons:n,onSelectCoupon:c,onRemoveCoupon:r,onShowCouponsModal:o}=e,i=(0,x.wA)();return(0,s.jsx)("div",{className:"backdrop-blur-sm bg-black/20 rounded-2xl p-8 border border-gray-500/30",children:(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)(K,{data:a}),(0,s.jsx)(M,{selectedSeats:a.selectedSeats,seatBreakdown:a.seatBreakdown}),(0,s.jsx)(ep,{selectedCoupon:l,availableCoupons:n,onSelectCoupon:c,onRemoveCoupon:r,onShowCouponsModal:o,discount:a.discount}),(0,s.jsx)(ea,{data:a}),(0,s.jsx)("button",{onClick:()=>{i((0,S._Z)({totalAmount:a.total,tax:a.taxes,amount:a.subtotal})),t()},className:"".concat(L().className," w-full py-4 bg-white text-black hover:bg-gradient-to-tr hover:from-violet-300 hover:to-yellow-100 font-medium  rounded-xl transition-all duration-200 transform hover:scale-[1.02] gap-2  text-lg  shadow-lg hover:bg-gray-100"),children:(0,s.jsxs)("div",{className:"flex items-center justify-center ",children:["Pay ₹",a.total]})}),(0,s.jsxs)("p",{className:"".concat(P().className," text-gray-500 text-xs text-center mt-3"),children:["By proceeding, you agree to our ",(0,s.jsx)("span",{className:"text-cyan-400",children:"Terms & Conditions"})]})]})})};var eg=t(35308),eb=t(47440);function eN(){let e=(0,n.useParams)(),a=(0,n.useRouter)(),t=(0,x.wA)();null==e||e.showtimeId;let c=(0,x.d4)(e=>e.booking.bookingData),[f,u]=(0,l.useState)(null),[h,p]=(0,l.useState)(!0),[y,g]=(0,l.useState)(!1),[N,j]=(0,l.useState)(!1),[v,w]=(0,l.useState)([]),[k,_]=(0,l.useState)(null),[A,F]=(0,l.useState)(0),[L,I]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{if(null==c?void 0:c.showtimeId)try{let e=await (0,eg.o)(c.showtimeId);e.data&&u(e.data),p(!1)}catch(e){console.log(e),p(!1)}})()},[null==c?void 0:c.showtimeId]),(0,l.useEffect)(()=>{(null==c?void 0:c.totalAmount)===0&&(null==c?void 0:c.amount)>0&&t((0,S.Zz)())},[null==c?void 0:c.totalAmount,null==c?void 0:c.amount,t]);let P=(0,l.useCallback)(e=>{if(!(null==f?void 0:f.rowPricing))return{price:150,type:"Standard"};let a=e.charAt(0),t=f.rowPricing.find(e=>e.rowLabel===a);return t?{price:t.showtimePrice||t.basePrice||150,type:t.seatType||"Standard"}:{price:150,type:"Standard"}},[null==f?void 0:f.rowPricing]),T=(0,l.useCallback)(e=>{if(!(null==f?void 0:f.rowPricing))return{id:"unknown"};let a=e.charAt(0),t=f.rowPricing.find(e=>e.rowLabel===a);return t?{id:t._id}:{id:"unknown"}},[null==f?void 0:f.rowPricing]),D=(0,l.useMemo)(()=>{if(!(null==c?void 0:c.selectedSeats)||!(null==f?void 0:f.rowPricing))return{breakdown:[],selectedRowIds:[]};let e=[],a=[];return c.selectedSeats.forEach(t=>{let s=P(t),l=T(t);e.push({type:s.type,displayType:"".concat(s.type," - ").concat(t),price:s.price,count:1,total:s.price,seats:[t],seatId:t}),l.id&&a.push(l.id)}),{breakdown:e,selectedRowIds:a}},[null==c?void 0:c.selectedSeats,null==f?void 0:f.rowPricing,P,T]);(0,l.useEffect)(()=>{!N&&D.selectedRowIds.length>0&&(t((0,S._Z)({selectedRowIds:D.selectedRowIds})),j(!0))},[D.selectedRowIds,N,t]),(0,l.useEffect)(()=>{(async()=>{if(null==c?void 0:c.theaterId)try{let e=await (0,eu.x8)(c.theaterId);w(e.data||[])}catch(e){console.error("Failed to fetch coupons:",e),w([])}})()},[null==c?void 0:c.theaterId]);let E=(0,l.useMemo)(()=>{var e,a,t,s,l,n,r,o,i,d,m;if(!c||!f)return null;let x=D.breakdown;return 0===x.length&&c.selectedSeats&&(x=c.selectedSeats.map(e=>({type:"Standard",displayType:"Standard - ".concat(e),price:Math.round(c.amount/c.selectedSeats.length),count:1,total:Math.round(c.amount/c.selectedSeats.length),seats:[e],seatId:e}))),{movieTitle:"object"==typeof f.movieId&&(null==(e=f.movieId)?void 0:e.title)?f.movieId.title:"Movie Title",moviePoster:"object"==typeof f.movieId&&(null==(a=f.movieId)?void 0:a.poster)?f.movieId.poster:void 0,movieRating:"object"==typeof f.movieId&&(null==(t=f.movieId)?void 0:t.rating)?f.movieId.rating:"0",theaterName:"object"==typeof f.theaterId&&(null==(s=f.theaterId)?void 0:s.name)?f.theaterId.name:"Theater Name",screenName:"object"==typeof f.screenId&&(null==(m=f.screenId)?void 0:m.name)?"Screen ".concat(f.screenId.name):"string"==typeof f.screenId?"Screen ".concat(f.screenId):"Screen 1",showDate:f.showDate?new Date(f.showDate).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):new Date().toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),showTime:f.showTime||"Show Time",format:f.format||"2D",language:f.language||"English",selectedSeats:c.selectedSeats,seatBreakdown:x,subtotal:(null==(l=c.priceDetails)?void 0:l.subtotal)||0,convenienceFee:(null==(n=c.priceDetails)?void 0:n.convenienceFee)||0,taxes:(null==(r=c.priceDetails)?void 0:r.taxes)||0,discount:(null==(o=c.priceDetails)?void 0:o.discount)||0,total:(null==(i=c.priceDetails)?void 0:i.total)||0,savings:(null==(d=c.priceDetails)?void 0:d.discount)||0,selectedCoupon:c.appliedCoupon||k,availableCoupons:v}},[c,f,D.breakdown,k,v]),z=(0,l.useCallback)(()=>{a.back()},[a]),R=(0,l.useCallback)(e=>{if(_(e),E){let a=Math.round(E.subtotal*(e.discountPercentage/100));F(a),t((0,S.VY)({coupon:e,discountAmount:a}))}I(!1)},[null==E?void 0:E.subtotal,t]),M=(0,l.useCallback)(()=>{_(null),t((0,S.TY)()),F(0)},[t]),B=(0,l.useCallback)(()=>{I(!0)},[]),W=(0,l.useCallback)(()=>{g(!0)},[]);return h||!E?(0,s.jsx)(m.A,{text:"Loading payment details"}):(0,s.jsx)(eb.A,{allowedRoles:["user"],children:(0,s.jsxs)("div",{className:"min-h-screen bg-black relative overflow-hidden",children:[(0,s.jsx)("div",{className:"fixed inset-0 z-10 opacity-30",children:(0,s.jsx)(i.A,{animationType:"rotate",timeScale:.5,height:3.5,baseWidth:5.5,scale:3.6,hueShift:0,colorFrequency:1,noise:0,glow:1.3})}),(0,s.jsx)(d.jq,{}),(0,s.jsx)("div",{className:"relative z-20 pb-12",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"relative pt-12 pb-8",children:[(0,s.jsxs)("button",{onClick:z,className:"".concat(r().className," flex items-center gap-2 text-gray-400 hover:text-white transition-all duration-300 absolute left-0 top-12 z-10"),children:[(0,s.jsx)("div",{className:"p-2 rounded-full bg-white/5 hover:bg-white/10 transition-all",children:(0,s.jsx)(o.A,{className:"w-5 h-5"})}),"Back to Seats"]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("p",{className:"".concat(b().className," text-4xl text-white mb-2"),children:"Complete Your Booking"})})]}),(0,s.jsx)(ey,{data:E,onPayment:W,selectedCoupon:k,availableCoupons:v,onSelectCoupon:R,onRemoveCoupon:M,onShowCouponsModal:B})]})}),y&&(0,s.jsx)(C,{totalAmount:E.total,onClose:()=>{g(!1)}})]})})}},35169:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35308:(e,a,t)=>{"use strict";t.d(a,{o:()=>n});let s={BY_ID:e=>"/users/showtime/".concat(e)};var l=t(77567);let n=async e=>(await l.A.get(s.BY_ID(e))).data},36632:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}},42783:(e,a,t)=>{Promise.resolve().then(t.bind(t,30710))},43332:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},45289:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_3f8a51"}},47863:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},52006:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:700,fontStyle:"normal"},className:"__className_81d908"}},54409:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});var s=t(95155),l=t(51154);t(12115);var n=t(70304),c=t.n(n);let r=e=>{let{text:a}=e;return(0,s.jsxs)("div",{children:["  ",(0,s.jsx)("div",{className:"flex items-center justify-center h-screen ",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(l.A,{className:"w-8 h-8 text-white animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"".concat(c().className," text-white"),children:a})]})})]})}},59002:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}},59556:(e,a,t)=>{"use strict";t.d(a,{C:()=>i});var s=t(95155);t(12115);var l=t(95552),n=t.n(l),c=t(74636),r=t.n(c),o=t(78499);let i=e=>{let{selectedMethod:a,onMethodSelect:t,walletBalance:l,totalAmount:c}=e;return(0,s.jsx)("div",{className:"space-y-3 mb-6",children:o.b.map(e=>{let o="wallet"===e.id,i=o&&null!==l&&l<c,d=!o||null!==l&&l>=c;return(0,s.jsxs)("label",{className:"flex items-center gap-4 p-4 rounded-xl border cursor-pointer transition-all duration-200 ".concat(a===e.id?"border-white/30 bg-white/10":i?"border-red-500/30 bg-red-500/5 opacity-60 cursor-not-allowed":"border-gray-600/30 bg-white/5 hover:border-gray-500/50"),children:[(0,s.jsx)("input",{type:"radio",name:"paymentMethod",value:e.id,checked:a===e.id,disabled:i,onChange:e=>{console.log(e.target.value),d&&t(e.target.value)},className:"hidden"}),(0,s.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all ".concat(a===e.id?"border-white bg-white":i?"border-red-500":"border-gray-500"),children:a===e.id&&(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-black"})}),(0,s.jsx)("div",{className:"p-3 rounded-lg border ".concat(i?"bg-red-500/10 border-red-600/20":"bg-white/10 border-gray-600/20"),children:(0,s.jsx)(e.icon,{className:"w-5 h-5 ".concat(i?"text-red-400":"text-white")})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("span",{className:"".concat(r().className," ").concat(i?"text-red-400":"text-white"),children:e.name}),e.popular&&!i&&(0,s.jsx)("span",{className:"".concat(n().className," px-3 py-1 bg-white/20 text-white text-xs rounded-full border border-gray-500/30"),children:"Popular"})]}),(0,s.jsx)("p",{className:"".concat(n().className," text-sm mb-1 ").concat(i?"text-red-400":"text-gray-400"),children:e.description}),o&&null!==l&&(0,s.jsx)("div",{className:"mb-1",children:(0,s.jsxs)("span",{className:"".concat(n().className," text-xs ").concat(i?"text-red-400":"text-green-400"),children:["Wallet Balance: ₹",null==l?void 0:l.toFixed(2)]})}),i&&(0,s.jsx)("div",{className:"mb-1",children:(0,s.jsx)("span",{className:"".concat(n().className," text-red-400 text-xs font-medium"),children:"Insufficient wallet balance"})}),e.offers&&!i&&(0,s.jsx)("span",{className:"".concat(n().className," text-gray-300 text-xs"),children:e.offers})]})]},e.id)})})}},66474:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},70304:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:500,fontStyle:"normal"},className:"__className_5a1147"}},70690:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_3f8a51"}},74636:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_3f8a51"}},81284:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},84061:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_3f8a51"}},86927:(e,a,t)=>{"use strict";t.d(a,{l:()=>l});var s=t(29663);class l extends s.V{constructor(e,{attributes:a={}}={}){Object.assign(a,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,a)}}},90933:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}},93335:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:700,fontStyle:"normal"},className:"__className_81d908"}},95247:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}},95552:e=>{e.exports={style:{fontFamily:"'Lexend', 'Lexend Fallback'",fontWeight:200,fontStyle:"normal"},className:"__className_9e6433"}}},e=>{e.O(0,[1613,4303,2601,730,7293,6344,4629,9151,9268,1410,9772,5947,3568,7440,2686,8465,8441,5964,7358],()=>e(e.s=42783)),_N_E=e.O()}]);